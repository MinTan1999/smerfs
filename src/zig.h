// The following constants were generated by the python script in smerfs/random.py

static const float log32 = 22.1807098f, // ln 1<<32
  tail = 3.654152885f, inv_tail = 0.273661237f; // Tail

// Integers to test if you are in the block
static const uint32_t in_block[256] = { 0x7799eb,0x78d2d1,0x7b362e,0x7c4fd1,0x7cf4b7,0x7d6201,0x7db035,0x7deb2b,0x7e1958,0x7e3e92,0x7e5d45,0x7e770f,0x7e8d0c,0x7ea009,0x7eb09c,0x7ebf36,0x7ecc2e,0x7ed7c6,0x7ee236,0x7eeba7,0x7ef43d,0x7efc14,0x7f0345,0x7f09e3,0x7f0fff,0x7f15a7,0x7f1ae8,0x7f1fcd,0x7f245d,0x7f28a2,0x7f2ca2,0x7f3063,0x7f33ec,0x7f373f,0x7f3a62,0x7f3d59,0x7f4026,0x7f42ce,0x7f4551,0x7f47b4,0x7f49f9,0x7f4c20,0x7f4e2d,0x7f5021,0x7f51fd,0x7f53c3,0x7f5574,0x7f5711,0x7f589c,0x7f5a15,0x7f5b7e,0x7f5cd6,0x7f5e20,0x7f5f5b,0x7f6089,0x7f61aa,0x7f62be,0x7f63c7,0x7f64c4,0x7f65b7,0x7f669f,0x7f677d,0x7f6852,0x7f691e,0x7f69e1,0x7f6a9b,0x7f6b4d,0x7f6bf7,0x7f6c9a,0x7f6d35,0x7f6dca,0x7f6e57,0x7f6ede,0x7f6f5e,0x7f6fd8,0x7f704c,0x7f70b9,0x7f7122,0x7f7184,0x7f71e1,0x7f7239,0x7f728b,0x7f72d9,0x7f7321,0x7f7365,0x7f73a3,0x7f73dd,0x7f7413,0x7f7444,0x7f7471,0x7f7499,0x7f74bd,0x7f74dc,0x7f74f8,0x7f750f,0x7f7523,0x7f7532,0x7f753e,0x7f7545,0x7f7549,0x7f7549,0x7f7545,0x7f753d,0x7f7532,0x7f7523,0x7f7510,0x7f74f9,0x7f74df,0x7f74c1,0x7f74a0,0x7f747a,0x7f7452,0x7f7425,0x7f73f5,0x7f73c1,0x7f738a,0x7f734f,0x7f7310,0x7f72ce,0x7f7288,0x7f723e,0x7f71f0,0x7f719f,0x7f714a,0x7f70f1,0x7f7095,0x7f7034,0x7f6fcf,0x7f6f67,0x7f6efb,0x7f6e8a,0x7f6e15,0x7f6d9d,0x7f6d20,0x7f6c9f,0x7f6c19,0x7f6b8f,0x7f6b01,0x7f6a6e,0x7f69d7,0x7f693b,0x7f689a,0x7f67f5,0x7f674a,0x7f669b,0x7f65e6,0x7f652c,0x7f646d,0x7f63a9,0x7f62de,0x7f620f,0x7f6139,0x7f605e,0x7f5f7c,0x7f5e94,0x7f5da6,0x7f5cb2,0x7f5bb6,0x7f5ab4,0x7f59ab,0x7f589a,0x7f5782,0x7f5663,0x7f553b,0x7f540c,0x7f52d4,0x7f5193,0x7f504a,0x7f4ef8,0x7f4d9c,0x7f4c36,0x7f4ac7,0x7f494d,0x7f47c8,0x7f4639,0x7f449d,0x7f42f6,0x7f4143,0x7f3f83,0x7f3db6,0x7f3bdb,0x7f39f1,0x7f37f9,0x7f35f2,0x7f33da,0x7f31b2,0x7f2f78,0x7f2d2d,0x7f2ace,0x7f285c,0x7f25d5,0x7f2339,0x7f2086,0x7f1dbb,0x7f1ad8,0x7f17db,0x7f14c3,0x7f118e,0x7f0e3b,0x7f0ac8,0x7f0735,0x7f037e,0x7effa2,0x7efb9f,0x7ef772,0x7ef31a,0x7eee93,0x7ee9db,0x7ee4ee,0x7edfc9,0x7eda69,0x7ed4ca,0x7ecee7,0x7ec8bb,0x7ec241,0x7ebb74,0x7eb44d,0x7eacc4,0x7ea4d3,0x7e9c71,0x7e9394,0x7e8a31,0x7e803c,0x7e75a9,0x7e6a67,0x7e5e66,0x7e5191,0x7e43d4,0x7e3513,0x7e2532,0x7e140f,0x7e0182,0x7ded5b,0x7dd766,0x7dbf60,0x7da4fb,0x7d87da,0x7d678a,0x7d437d,0x7d1b06,0x7ced47,0x7cb925,0x7c7d31,0x7c3787,0x7be596,0x7b83d2,0x7b0d2e,0x7a7a33,0x79bf6a,0x78ca37,0x777a5b,0x7592ae,0x728fb3,0x6d1aa6,0x6045f4,0x0 };

// 23-bit integer to float
static const float to_float[256] = { 4.661987e-07f,4.356090e-07f,4.111861e-07f,3.958041e-07f,3.843993e-07f,3.752577e-07f,3.675850e-07f,3.609464e-07f,3.550772e-07f,3.498038e-07f,3.450062e-07f,3.405975e-07f,3.365132e-07f,3.327038e-07f,3.291302e-07f,3.257615e-07f,3.225725e-07f,3.195423e-07f,3.166537e-07f,3.138920e-07f,3.112448e-07f,3.087016e-07f,3.062529e-07f,3.038909e-07f,3.016085e-07f,2.993995e-07f,2.972583e-07f,2.951801e-07f,2.931605e-07f,2.911956e-07f,2.892818e-07f,2.874158e-07f,2.855949e-07f,2.838162e-07f,2.820775e-07f,2.803764e-07f,2.787109e-07f,2.770791e-07f,2.754794e-07f,2.739100e-07f,2.723695e-07f,2.708565e-07f,2.693698e-07f,2.679080e-07f,2.664702e-07f,2.650551e-07f,2.636620e-07f,2.622897e-07f,2.609376e-07f,2.596047e-07f,2.582902e-07f,2.569935e-07f,2.557139e-07f,2.544507e-07f,2.532033e-07f,2.519712e-07f,2.507537e-07f,2.495503e-07f,2.483606e-07f,2.471841e-07f,2.460203e-07f,2.448688e-07f,2.437291e-07f,2.426010e-07f,2.414839e-07f,2.403777e-07f,2.392818e-07f,2.381960e-07f,2.371199e-07f,2.360534e-07f,2.349960e-07f,2.339474e-07f,2.329075e-07f,2.318760e-07f,2.308526e-07f,2.298370e-07f,2.288291e-07f,2.278286e-07f,2.268353e-07f,2.258490e-07f,2.248695e-07f,2.238966e-07f,2.229301e-07f,2.219698e-07f,2.210156e-07f,2.200673e-07f,2.191247e-07f,2.181876e-07f,2.172559e-07f,2.163295e-07f,2.154082e-07f,2.144918e-07f,2.135803e-07f,2.126734e-07f,2.117711e-07f,2.108732e-07f,2.099796e-07f,2.090902e-07f,2.082048e-07f,2.073234e-07f,2.064458e-07f,2.055719e-07f,2.047016e-07f,2.038348e-07f,2.029713e-07f,2.021112e-07f,2.012543e-07f,2.004005e-07f,1.995496e-07f,1.987017e-07f,1.978565e-07f,1.970141e-07f,1.961743e-07f,1.953371e-07f,1.945023e-07f,1.936699e-07f,1.928397e-07f,1.920118e-07f,1.911860e-07f,1.903622e-07f,1.895404e-07f,1.887205e-07f,1.879023e-07f,1.870859e-07f,1.862711e-07f,1.854580e-07f,1.846463e-07f,1.838360e-07f,1.830271e-07f,1.822195e-07f,1.814131e-07f,1.806078e-07f,1.798036e-07f,1.790004e-07f,1.781981e-07f,1.773966e-07f,1.765960e-07f,1.757960e-07f,1.749967e-07f,1.741980e-07f,1.733997e-07f,1.726019e-07f,1.718045e-07f,1.710073e-07f,1.702104e-07f,1.694136e-07f,1.686169e-07f,1.678203e-07f,1.670235e-07f,1.662267e-07f,1.654296e-07f,1.646322e-07f,1.638346e-07f,1.630364e-07f,1.622378e-07f,1.614386e-07f,1.606388e-07f,1.598383e-07f,1.590369e-07f,1.582347e-07f,1.574315e-07f,1.566273e-07f,1.558219e-07f,1.550154e-07f,1.542076e-07f,1.533984e-07f,1.525877e-07f,1.517755e-07f,1.509617e-07f,1.501461e-07f,1.493288e-07f,1.485095e-07f,1.476882e-07f,1.468647e-07f,1.460391e-07f,1.452112e-07f,1.443808e-07f,1.435479e-07f,1.427123e-07f,1.418740e-07f,1.410328e-07f,1.401887e-07f,1.393414e-07f,1.384908e-07f,1.376369e-07f,1.367794e-07f,1.359183e-07f,1.350533e-07f,1.341844e-07f,1.333114e-07f,1.324342e-07f,1.315524e-07f,1.306661e-07f,1.297750e-07f,1.288789e-07f,1.279776e-07f,1.270710e-07f,1.261588e-07f,1.252408e-07f,1.243167e-07f,1.233865e-07f,1.224496e-07f,1.215061e-07f,1.205555e-07f,1.195975e-07f,1.186320e-07f,1.176585e-07f,1.166767e-07f,1.156863e-07f,1.146870e-07f,1.136783e-07f,1.126598e-07f,1.116311e-07f,1.105917e-07f,1.095412e-07f,1.084790e-07f,1.074046e-07f,1.063174e-07f,1.052168e-07f,1.041020e-07f,1.029725e-07f,1.018273e-07f,1.006657e-07f,9.948676e-08f,9.828953e-08f,9.707293e-08f,9.583583e-08f,9.457697e-08f,9.329499e-08f,9.198839e-08f,9.065551e-08f,8.929452e-08f,8.790342e-08f,8.647993e-08f,8.502154e-08f,8.352541e-08f,8.198833e-08f,8.040665e-08f,7.877620e-08f,7.709215e-08f,7.534889e-08f,7.353986e-08f,7.165726e-08f,6.969176e-08f,6.763200e-08f,6.546399e-08f,6.317017e-08f,6.072800e-08f,5.810786e-08f,5.526953e-08f,5.215626e-08f,4.868378e-08f,4.471795e-08f,4.002304e-08f,3.411467e-08f,2.565884e-08f };

// exp(-0.5 x*x) for x in the ziggurat steps
static const float y[255] = { 1.26028593e-03f,2.60907275e-03f,4.03797259e-03f,5.52240330e-03f,7.05087547e-03f,8.61658277e-03f,1.02149714e-02f,1.18427579e-02f,1.34974506e-02f,1.51770883e-02f,1.68800832e-02f,1.86051213e-02f,2.03510962e-02f,2.21170627e-02f,2.39022033e-02f,2.57058040e-02f,2.75272357e-02f,2.93659398e-02f,3.12214172e-02f,3.30932195e-02f,3.49809415e-02f,3.68842157e-02f,3.88027074e-02f,4.07361107e-02f,4.26841449e-02f,4.46465523e-02f,4.66230949e-02f,4.86135532e-02f,5.06177239e-02f,5.26354183e-02f,5.46664613e-02f,5.67106901e-02f,5.87679529e-02f,6.08381083e-02f,6.29210244e-02f,6.50165780e-02f,6.71246538e-02f,6.92451444e-02f,7.13779491e-02f,7.35229737e-02f,7.56801304e-02f,7.78493367e-02f,8.00305158e-02f,8.22235958e-02f,8.44285096e-02f,8.66451945e-02f,8.88735921e-02f,9.11136481e-02f,9.33653119e-02f,9.56285367e-02f,9.79032790e-02f,1.00189499e-01f,1.02487159e-01f,1.04796226e-01f,1.07116668e-01f,1.09448457e-01f,1.11791568e-01f,1.14145978e-01f,1.16511666e-01f,1.18888613e-01f,1.21276805e-01f,1.23676228e-01f,1.26086870e-01f,1.28508722e-01f,1.30941777e-01f,1.33386030e-01f,1.35841477e-01f,1.38308116e-01f,1.40785950e-01f,1.43274979e-01f,1.45775208e-01f,1.48286643e-01f,1.50809291e-01f,1.53343161e-01f,1.55888265e-01f,1.58444614e-01f,1.61012223e-01f,1.63591108e-01f,1.66181286e-01f,1.68782775e-01f,1.71395596e-01f,1.74019770e-01f,1.76655321e-01f,1.79302275e-01f,1.81960656e-01f,1.84630492e-01f,1.87311814e-01f,1.90004652e-01f,1.92709037e-01f,1.95425004e-01f,1.98152587e-01f,2.00891822e-01f,2.03642749e-01f,2.06405406e-01f,2.09179835e-01f,2.11966076e-01f,2.14764175e-01f,2.17574177e-01f,2.20396127e-01f,2.23230076e-01f,2.26076071e-01f,2.28934165e-01f,2.31804411e-01f,2.34686862e-01f,2.37581574e-01f,2.40488606e-01f,2.43408015e-01f,2.46339864e-01f,2.49284212e-01f,2.52241126e-01f,2.55210670e-01f,2.58192911e-01f,2.61187919e-01f,2.64195764e-01f,2.67216518e-01f,2.70250256e-01f,2.73297054e-01f,2.76356989e-01f,2.79430142e-01f,2.82516593e-01f,2.85616427e-01f,2.88729728e-01f,2.91856586e-01f,2.94997088e-01f,2.98151327e-01f,3.01319396e-01f,3.04501392e-01f,3.07697413e-01f,3.10907558e-01f,3.14131932e-01f,3.17370638e-01f,3.20623785e-01f,3.23891482e-01f,3.27173843e-01f,3.30470981e-01f,3.33783016e-01f,3.37110067e-01f,3.40452257e-01f,3.43809713e-01f,3.47182564e-01f,3.50570941e-01f,3.53974981e-01f,3.57394820e-01f,3.60830601e-01f,3.64282468e-01f,3.67750570e-01f,3.71235058e-01f,3.74736087e-01f,3.78253817e-01f,3.81788411e-01f,3.85340035e-01f,3.88908860e-01f,3.92495061e-01f,3.96098819e-01f,3.99720315e-01f,4.03359739e-01f,4.07017284e-01f,4.10693148e-01f,4.14387534e-01f,4.18100650e-01f,4.21832709e-01f,4.25583931e-01f,4.29354541e-01f,4.33144769e-01f,4.36954853e-01f,4.40785035e-01f,4.44635565e-01f,4.48506702e-01f,4.52398707e-01f,4.56311853e-01f,4.60246418e-01f,4.64202689e-01f,4.68180961e-01f,4.72181538e-01f,4.76204733e-01f,4.80250866e-01f,4.84320269e-01f,4.88413285e-01f,4.92530264e-01f,4.96671569e-01f,5.00837575e-01f,5.05028668e-01f,5.09245246e-01f,5.13487721e-01f,5.17756517e-01f,5.22052075e-01f,5.26374847e-01f,5.30725304e-01f,5.35103932e-01f,5.39511234e-01f,5.43947731e-01f,5.48413963e-01f,5.52910490e-01f,5.57437894e-01f,5.61996776e-01f,5.66587763e-01f,5.71211507e-01f,5.75868683e-01f,5.80559996e-01f,5.85286179e-01f,5.90047996e-01f,5.94846244e-01f,5.99681753e-01f,6.04555391e-01f,6.09468065e-01f,6.14420724e-01f,6.19414361e-01f,6.24450016e-01f,6.29528780e-01f,6.34651799e-01f,6.39820277e-01f,6.45035481e-01f,6.50298743e-01f,6.55611471e-01f,6.60975148e-01f,6.66391344e-01f,6.71861720e-01f,6.77388036e-01f,6.82972162e-01f,6.88616083e-01f,6.94321916e-01f,7.00091918e-01f,7.05928501e-01f,7.11834249e-01f,7.17811933e-01f,7.23864533e-01f,7.29995265e-01f,7.36207598e-01f,7.42505296e-01f,7.48892447e-01f,7.55373507e-01f,7.61953347e-01f,7.68637316e-01f,7.75431305e-01f,7.82341833e-01f,7.89376144e-01f,7.96542330e-01f,8.03849483e-01f,8.11307874e-01f,8.18929192e-01f,8.26726834e-01f,8.34716293e-01f,8.42915653e-01f,8.51346258e-01f,8.60033621e-01f,8.69008688e-01f,8.78309656e-01f,8.87984661e-01f,8.98095922e-01f,9.08726440e-01f,9.19991505e-01f,9.32060076e-01f,9.45198953e-01f,9.59879092e-01f,9.77101701e-01f };

// diff(exp(-0.5 x*x))/(1<<32) for x in the ziggurat steps
static const float y_seg[255] = {3.14038902e-13f, 3.32691671e-13f, 3.45620957e-13f, 3.55875160e-13f, 3.64544638e-13f, 3.72153863e-13f, 3.78998559e-13f, 3.85263177e-13f, 3.91071128e-13f, 3.96509386e-13f, 4.01641737e-13f, 4.06516472e-13f, 4.11171112e-13f, 4.15635435e-13f, 4.19933513e-13f, 4.24085106e-13f, 4.28106656e-13f, 4.32012005e-13f, 4.35812927e-13f, 4.39519529e-13f, 4.43140563e-13f, 4.46683661e-13f, 4.50155523e-13f, 4.53562071e-13f, 4.56908563e-13f, 4.60199698e-13f, 4.63439690e-13f, 4.66632341e-13f, 4.69781090e-13f, 4.72889060e-13f, 4.75959103e-13f, 4.78993825e-13f, 4.81995621e-13f, 4.84966693e-13f, 4.87909078e-13f, 4.90824659e-13f, 4.93715184e-13f, 4.96582282e-13f, 4.99427471e-13f, 5.02252170e-13f, 5.05057709e-13f, 5.07845337e-13f, 5.10616228e-13f, 5.13371489e-13f, 5.16112167e-13f, 5.18839252e-13f, 5.21553680e-13f, 5.24256343e-13f, 5.26948087e-13f, 5.29629720e-13f, 5.32302011e-13f, 5.34965697e-13f, 5.37621481e-13f, 5.40270040e-13f, 5.42912020e-13f, 5.45548046e-13f, 5.48178717e-13f, 5.50804613e-13f, 5.53426290e-13f, 5.56044290e-13f, 5.58659136e-13f, 5.61271333e-13f, 5.63881374e-13f, 5.66489737e-13f, 5.69096887e-13f, 5.71703277e-13f, 5.74309350e-13f, 5.76915537e-13f, 5.79522261e-13f, 5.82129935e-13f, 5.84738964e-13f, 5.87349746e-13f, 5.89962671e-13f, 5.92578124e-13f, 5.95196484e-13f, 5.97818122e-13f, 6.00443407e-13f, 6.03072702e-13f, 6.05706367e-13f, 6.08344757e-13f, 6.10988225e-13f, 6.13637120e-13f, 6.16291789e-13f, 6.18952577e-13f, 6.21619827e-13f, 6.24293880e-13f, 6.26975076e-13f, 6.29663755e-13f, 6.32360254e-13f, 6.35064913e-13f, 6.37778069e-13f, 6.40500061e-13f, 6.43231228e-13f, 6.45971909e-13f, 6.48722445e-13f, 6.51483178e-13f, 6.54254452e-13f, 6.57036611e-13f, 6.59830003e-13f, 6.62634978e-13f, 6.65451887e-13f, 6.68281086e-13f, 6.71122933e-13f, 6.73977788e-13f, 6.76846017e-13f, 6.79727989e-13f, 6.82624075e-13f, 6.85534654e-13f, 6.88460105e-13f, 6.91400817e-13f, 6.94357181e-13f, 6.97329593e-13f, 7.00318456e-13f, 7.03324179e-13f, 7.06347176e-13f, 7.09387870e-13f, 7.12446688e-13f, 7.15524067e-13f, 7.18620448e-13f, 7.21736283e-13f, 7.24872031e-13f, 7.28028159e-13f, 7.31205145e-13f, 7.34403473e-13f, 7.37623639e-13f, 7.40866148e-13f, 7.44131517e-13f, 7.47420271e-13f, 7.50732950e-13f, 7.54070104e-13f, 7.57432293e-13f, 7.60820093e-13f, 7.64234093e-13f, 7.67674894e-13f, 7.71143113e-13f, 7.74639381e-13f, 7.78164344e-13f, 7.81718665e-13f, 7.85303025e-13f, 7.88918120e-13f, 7.92564666e-13f, 7.96243396e-13f, 7.99955065e-13f, 8.03700448e-13f, 8.07480339e-13f, 8.11295558e-13f, 8.15146945e-13f, 8.19035365e-13f, 8.22961709e-13f, 8.26926894e-13f, 8.30931863e-13f, 8.34977590e-13f, 8.39065075e-13f, 8.43195353e-13f, 8.47369489e-13f, 8.51588582e-13f, 8.55853767e-13f, 8.60166217e-13f, 8.64527141e-13f, 8.68937790e-13f, 8.73399458e-13f, 8.77913481e-13f, 8.82481244e-13f, 8.87104179e-13f, 8.91783768e-13f, 8.96521548e-13f, 9.01319113e-13f, 9.06178112e-13f, 9.11100259e-13f, 9.16087333e-13f, 9.21141178e-13f, 9.26263714e-13f, 9.31456932e-13f, 9.36722907e-13f, 9.42063795e-13f, 9.47481840e-13f, 9.52979382e-13f, 9.58558856e-13f, 9.64222804e-13f, 9.69973876e-13f, 9.75814838e-13f, 9.81748582e-13f, 9.87778127e-13f, 9.93906633e-13f, 1.00013740e-12f, 1.00647390e-12f, 1.01291976e-12f, 1.01947877e-12f, 1.02615493e-12f, 1.03295244e-12f, 1.03987569e-12f, 1.04692932e-12f, 1.05411820e-12f, 1.06144748e-12f, 1.06892256e-12f, 1.07654917e-12f, 1.08433334e-12f, 1.09228146e-12f, 1.10040027e-12f, 1.10869693e-12f, 1.11717904e-12f, 1.12585464e-12f, 1.13473229e-12f, 1.14382110e-12f, 1.15313077e-12f, 1.16267165e-12f, 1.17245478e-12f, 1.18249198e-12f, 1.19279590e-12f, 1.20338010e-12f, 1.21425916e-12f, 1.22544875e-12f, 1.23696576e-12f, 1.24882841e-12f, 1.26105643e-12f, 1.27367116e-12f, 1.28669579e-12f, 1.30015552e-12f, 1.31407784e-12f, 1.32849280e-12f, 1.34343328e-12f, 1.35893542e-12f, 1.37503900e-12f, 1.39178796e-12f, 1.40923095e-12f, 1.42742207e-12f, 1.44642162e-12f, 1.46629713e-12f, 1.48712445e-12f, 1.50898921e-12f, 1.53198846e-12f, 1.55623280e-12f, 1.58184887e-12f, 1.60898261e-12f, 1.63780314e-12f, 1.66850790e-12f, 1.70132908e-12f, 1.73654201e-12f, 1.77447621e-12f, 1.81553009e-12f, 1.86019089e-12f, 1.90906230e-12f, 1.96290327e-12f, 2.02268426e-12f, 2.08967059e-12f, 2.16555031e-12f, 2.25263763e-12f, 2.35421144e-12f, 2.47511038e-12f, 2.62285233e-12f, 2.80993314e-12f, 3.05913330e-12f, 3.41798606e-12f, 4.00995125e-12f, 5.33142563e-12f};
